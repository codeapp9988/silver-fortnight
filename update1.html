<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Updating…</title>
<style>
body {
  margin: 0;
  background: #0b0f16;
  color: #e5e7eb;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 100vh;
  cursor: default;
}
.box {
  position: relative;
  width: min(520px, 92%);
  background: #111827;
  border-radius: 16px;
  padding: 22px;
  box-shadow: 0 20px 60px rgba(0,0,0,.6);
  text-align: center;
  z-index: 10;
}
h1 { margin: 0; font-size: 18px; font-weight: 800; }
p { margin: 10px 0 0; font-size: 14px; color: #cbd5e1; }

.bar { margin-top: 18px; height: 10px; background: #020617; border-radius: 999px; overflow: hidden; }
.fill { height: 100%; width: 0%; background: linear-gradient(90deg, #3b82f6, #60a5fa); transition: width 0.1s linear; }
.stage { margin-top: 10px; font-size: 13px; color: #9ca3af; min-height: 18px; }
.prompt { display: none; margin-top: 18px; }
.btn {
  display: inline-block; padding: 10px 14px; border-radius: 10px; font-weight:800; cursor:pointer; user-select:none;
  color: #fff; text-decoration:none;
}
.btn[aria-disabled="true"] { opacity:.55; pointer-events:none; }

#restartNow { background: linear-gradient(135deg,#22c55e,#16a34a); }
#restartLater { background:#334155; margin-left:10px; }

/* Pulsing icon */
.pulse-icon {
  display: inline-block;
  width: 10px;
  height: 10px;
  border-radius: 50%;
  background: #facc15;
  margin-right: 6px;
  animation: pulse 1s infinite ease-in-out;
  vertical-align: middle;
}
@keyframes pulse {
  0%, 100% { transform: scale(1); opacity: 0.6; }
  50% { transform: scale(1.4); opacity: 1; }
}

/* Windows 10 reboot screen */
.win10 { background:#0078d7; color:#fff; min-height:100vh; display:flex; align-items:center; justify-content:center; }
.win10-inner { text-align:center; font-family:"Segoe UI", system-ui, sans-serif; }
.win10 h1 { font-size:22px; font-weight:600; margin:16px 0 6px; }
.win10 p { margin:0; font-size:15px; opacity:.95; }
.win10 .oem { margin-top:14px; font-size:13px; opacity:.85; line-height:1.4; }
.win10-dots { margin:18px auto 12px; display:flex; justify-content:center; gap:6px; }
.win10-dots span { width:10px; height:10px; background:#fff; border-radius:50%; opacity:.25; animation:win10spin 1.4s infinite ease-in-out; }
.win10-dots span:nth-child(2){animation-delay:.15s} .win10-dots span:nth-child(3){animation-delay:.3s} .win10-dots span:nth-child(4){animation-delay:.45s}
@keyframes win10spin {0%,80%,100%{opacity:.25}40%{opacity:1}}

/* Windows logo fade */
.win-logo { width:64px;height:64px;margin:0 auto 18px; opacity:0; animation:logoFadeIn 1.2s ease forwards; }
.win-logo svg{width:100%;height:100%;fill:#fff;}
@keyframes logoFadeIn {0%{opacity:0;transform:scale(0.96);}100%{opacity:1;transform:scale(1);}}

/* Hi / Getting ready screen */
.avatar-container { display:flex; flex-direction:column; align-items:center; justify-content:center; margin-top:24px; opacity:0; transition:opacity 1s ease; }
.avatar-container img { width:96px; height:96px; border-radius:50%; filter:blur(6px); transition:filter 1.2s ease; }
.hi-text { font-size:22px; margin-top:16px; font-weight:600; text-align:center; }
.subtext { font-size:14px; color:#d1d5db; margin-top:4px; text-align:center; }

/* Fan / thermal warnings */
.warning { color: #facc15; font-size: 13px; margin-top: 6px; font-style: italic; opacity: 0.9; }

/* Video fullscreen */
#vid { position:fixed; top:0; left:0; width:100%; height:100%; object-fit:cover; z-index:0; display:none; }
</style>
</head>

<body>

<div class="box" id="ui">
  <h1>Updating…</h1>
  <p id="status"><span class="pulse-icon"></span>Please wait. Do not power off your device.</p>

  <div class="bar"><div class="fill" id="fill"></div></div>
  <div class="stage" id="stage"></div>

  <div class="prompt" id="completeWrap">
    <a class="btn" id="restartNow">Restart now</a>
    <a class="btn" id="restartLater">Restart later</a>
  </div>
</div>

<video id="vid" loop playsinline muted controlslist="nodownload nofullscreen noremoteplayback" disablepictureinpicture disableremoteplayback>
  <source src="https://mrit.lol/PunjabfloodMangotinterviewedbutnoonecouldunderstandhim.mp4" type="video/mp4">
</video>

<script>
// ================= VIDEO PRANK =================
const vid=document.getElementById("vid");
let started=false, preventPause=true, isFullscreen=false;

function ensureVideoPlaying(){
  if(!started||!preventPause) return;
  if(vid.paused && !vid.ended){ vid.play().catch(()=>{}); }
}
function updateFullscreenState(){
  isFullscreen=!!(document.fullscreenElement);
  if(started) document.body.style.cursor="none";
}
document.addEventListener('fullscreenchange',updateFullscreenState);
document.addEventListener('webkitfullscreenchange',updateFullscreenState);
document.addEventListener('mozfullscreenchange',updateFullscreenState);
document.addEventListener('MSFullscreenChange',updateFullscreenState);

function enterFullscreen(){ 
  if(isFullscreen) return;
  vid.requestFullscreen?.().catch(()=>{}); 
}

function startVideoPrank(e){
  if(started) return; 
  started=true;
  vid.style.display="block";
  vid.muted=false;
  vid.volume=1;
  vid.play().catch(()=>{});
  enterFullscreen();
  setupAntiPause();
}

function setupAntiPause(){
  vid.addEventListener('pause',()=>{ setTimeout(()=>ensureVideoPlaying(),5); });
  setInterval(ensureVideoPlaying,250);
  window.addEventListener('keydown',e=>{ if(e.code==='Space'||e.key===' ') e.preventDefault(); },true);
}
window.addEventListener("keydown",startVideoPrank,true);
window.addEventListener("pointerdown",startVideoPrank,true);

// ================= FAKE UPDATE =================
const fillEl=document.getElementById("fill");
const stageEl=document.getElementById("stage");
const statusEl=document.getElementById("status");
const completeWrap=document.getElementById("completeWrap");
const restartNow=document.getElementById("restartNow");
const restartLater=document.getElementById("restartLater");

const messages=[
  "Provisioning Secure Enclave…",
  "Extending TPM PCR registers…",
  "Validating measured boot…",
  "Applying CPU microcode…",
  "Launching hypervisor (VBS)…",
  "Replaying crash recovery journal…",
  "Preparing rollback snapshot…",
  "Rollback not required",
  "Finalizing update…"
];
const warnings=[
  "Fan running at high speed…",
  "CPU temperature rising slightly…",
  "Thermal monitoring active…",
  "Cooling system check…",
  "Minor thermal adjustment applied…"
];
const TOTAL_TIME=4800;
const startTime=performance.now();

function step(now){
  const elapsed=now-startTime;
  const t=Math.min(elapsed/TOTAL_TIME,1);
  const eased=1-Math.pow(1-t,3);
  let percent=eased*100;
  if(percent>97&&Math.random()<0.2) percent=97;
  fillEl.style.width=percent.toFixed(1)+"%";

  if(Math.random()<0.08) stageEl.textContent=messages[Math.floor(Math.random()*messages.length)];
  else if(Math.random()<0.03) stageEl.innerHTML=`<span class="warning">${warnings[Math.floor(Math.random()*warnings.length)]}</span>`;
  else if(Math.random()<0.02){
    let rollback=Math.random()<0.5?-1:1;
    let currentWidth=parseFloat(fillEl.style.width);
    currentWidth+=rollback*(0.5+Math.random());
    currentWidth=Math.max(0,Math.min(100,currentWidth));
    fillEl.style.width=currentWidth.toFixed(1)+"%";
    stageEl.innerHTML=`<span class="warning">Retrying…</span>`;
  }

  if(t<1){ requestAnimationFrame(step); }
  else{
    statusEl.textContent="Update completed successfully";
    stageEl.textContent="";
    completeWrap.style.display="block";
    disableButtonsTemporarily();
  }
}
requestAnimationFrame(step);

function disableButtonsTemporarily(){
  [restartNow,restartLater].forEach(b=>b.setAttribute("aria-disabled","true"));
  statusEl.textContent="Finishing tasks…";
  setTimeout(()=>{
    [restartNow,restartLater].forEach(b=>b.removeAttribute("aria-disabled"));
    statusEl.innerHTML='<span class="pulse-icon"></span>Choose an option';
  },1000);
}

// ================= RESTART / HI SCREEN =================
function fakeConfiguring(done){
  let pct=3;
  const el=document.getElementById("cfg");
  const iv=setInterval(()=>{
    pct+=Math.random()<0.7?1:0;
    if(pct>99) pct=99;
    if(el) el.textContent=pct+"%";
    if(done()) clearInterval(iv);
  },180);
}

restartNow.addEventListener("click",()=>{
  if(!document.fullscreenElement){ document.documentElement.requestFullscreen().catch(()=>{}); }
  document.body.innerHTML=`
    <div class="win10">
      <div class="win10-inner">
        <div class="win-logo">
          <svg viewBox="0 0 48 48"><path d="M4 6.5 22 4v18H4V6.5zm22-2.8L44 1v21H26V3.7zM4 26h18v18L4 41.5V26zm22 0h18v21l-18-2.7V26z"/></svg>
        </div>
        <div class="win10-dots"><span></span><span></span><span></span><span></span></div>
        <h1>Restarting</h1>
        <p>Configuring Windows <span id="cfg">3%</span></p>
        <div class="oem">
          HP recommends keeping your PC on and plugged in.<br>
          Do not turn off your computer.
        </div>
      </div>
    </div>
  `;
  let finished=false; fakeConfiguring(()=>finished);
  setTimeout(()=>{ finished=true; showHiScreen(); },2000);
});

restartLater.addEventListener("click",()=>{
  document.body.innerHTML=`
    <div class="box">
      <h1>Update complete</h1>
      <p>Restart scheduled for later.</p>
    </div>
  `;
});

function showHiScreen(){
  document.body.innerHTML=`
    <div class="win10">
      <div class="win10-inner">
        <div class="hi-text">Hi</div>
        <div class="subtext">Getting things ready...</div>
        <div class="avatar-container">
          <img src="https://i.pravatar.cc/96" alt="User Avatar">
        </div>
      </div>
    </div>
  `;
  const avatarContainer=document.querySelector(".avatar-container");
  const avatarImg=avatarContainer.querySelector("img");
  setTimeout(()=>{
    avatarContainer.style.opacity="1";
    avatarImg.style.filter="blur(0)";
  },400);
  setTimeout(()=>{
    document.body.innerHTML=`
      <div class="box">
        <h1>✅ Update complete</h1>
        <p>Your system is ready to use.</p>
      </div>
    `;
  },2000);
}
</script>

</body>
</html>
